<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Settings | Change Password</title>
  <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-0evHe/X+R7YkIZDRvuzKMRqM+OrBnVFBL6DOitfPri4tjfHxaWutUpFmBp4vmVor" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-pprn3073KE6tl6bjs2QrFaJGz5/SUsLqktiwsUTF55Jfv3qYSDhgCecCxMW52nD2"
    crossorigin="anonymous"></script>
    <script src="https://kit.fontawesome.com/d67b07a9d9.js" crossorigin="anonymous"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<style>
  .start-100 {
    left: 97% !important;
}
body{
    background-image: url(https://images.unsplash.com/photo-1511389290465-d11bafd4c1df?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1170&q=80);
    background-size: cover;
}
</style>
</head>


<body style="overflow-x: hidden;padding-bottom: 50px;">

     <!-- navbar start -->

  <nav class="navbar navbar-expand-sm bg-dark navbar-dark" style="background-color: rgb(0, 0, 0) !important;">
    <div class="container-fluid">
      <a class="navbar-brand ps-3" href="/user_home">
        <img src="/static/home/images/R4Rooms.png" width="130" height="45" alt="LOGO">
      </a>
    </div>
    <div class="container">
      <!-- <form class="form-inline my-2 my-lg-0" method="post"> -->
      <input class="form-control mr-sm-2" type="search" placeholder="Search Your Location..." aria-label="Search">
      <a href="/user/room_search" style="text-decoration: none;"> <button class="btn btn-outline-success my-2 my-sm-0"
          type="submit">Search</button></a>
      <!-- </form> -->
    </div>

    <div class="dropdown me-4">
      <button class="btn btn-dark dropdown-toggle" type="button" id="dropdownMenuButton1" data-bs-toggle="dropdown"
        aria-expanded="false">
        EN
      </button>
      <ul class="dropdown-menu bg-dark" aria-labelledby="dropdownMenuButton1">
        <li><a class="dropdown-item bg-dark text-white" href="#">French</a></li>
        <li><a class="dropdown-item bg-dark text-white" href="#">Hindi</a></li>
        <li><a class="dropdown-item bg-dark text-white" href="#">Tamil</a></li>
      </ul>
    </div>



    

    {{if ne .wcount 0}}<a href="/user/wishlist" class="pe-3"><img src="/static/home/images/wishlist.png"
      class="position-relative" style="max-width: 2rem;">
    <span class="badge text-bg-primary position-absolute">{{.wcount}}</span>
  </a>{{else}}<a href="/user/wishlist" class="pe-3"><img src="/static/home/images/wishlist.png"
      class="position-relative" style="max-width: 2rem;"></a>
  {{end}}


  {{if ne .count 0}} <a href="/user/cart" class="pe-5 ps-3"><img src="/static/home/images/trolley.png"
      class="position-relative" style="max-width: 2.2rem;">
    <span class="badge text-bg-danger position-absolute">{{.count}}</span>
  </a>{{else}}
  <a href="/user/cart" class="me-5" style="width: 7%;"> <img class="position-relative"
      src="/static/home/images/trolley.png" style="width: 38px"></a>{{end}}


      {{if not .username}} <button type="button" class="btn btn-sm btn-outline-warning text-white"><a href="/user_signup"
        class="navbar nav-item text-white" style="text-decoration: none;">SignUp</a></button> 
        <button type="button" class="btn btn-sm btn-outline-info text-white me-4" style="margin-left: 1%;"><a
          href="/user_login" class="navbar nav-item text-white" style="text-decoration: none;">Login</a></button> </a>
          {{end}}

                 <!-- profile icon -->
    <!-- <script src="https://kit.fontawesome.com/d67b07a9d9.js" crossorigin="anonymous"></script> -->

    <div class="btn-group bg-dark me-4" role="group" aria-label="Button group with nested dropdown">
      {{if .username}}    <button type="button" class="btn" style="color: white; font-family: 'Courier New', Courier, monospace;font-weight: 600;">{{.username}}</button>
      {{else}}<button type="button" class="btn" style="color: white; font-family: 'Courier New', Courier, monospace;font-weight: 600;">Guest</button>{{end}}
  
        <div class="btn-group dropstart" role="group">
          <button id="btnGroupDrop1" type="button" class="btn btn-primary dropdown-toggle" data-bs-toggle="dropdown"
            aria-expanded="false">
  
          </button>
          <ul class="dropdown-menu bg-dark " aria-labelledby="btnGroupDrop1">
            <li><a class="dropdown-item text-white" href="/user/profile"><div class="fa-solid fa-user"></div>  Profile</a></li>
            <li><a class="dropdown-item text-white" href="#"><div class="fa-brands fa-first-order"></div>Orders</a></li>
            <li><a class="dropdown-item text-white" href="#"><div class="fa-solid fa-gear"></div> Settings</a></li>
        {{if .username}}    <li><a class="dropdown-item text-white" href="/user_logout"><div class="fa-solid fa-right-from-bracket"></div> Log Out</a></li>{{else}}
        <li><a class="dropdown-item text-white" href="/user_login"> <div class="fa-solid fa-arrow-right-to-bracket"></div> Sign In</a></li>{{end}}
          </ul>
        </div>
      </div>
      <!-- profile icon ends -->
  </nav>
  <!-- navbar end -->
 
<div class="container">
  <form id="form" method="post"> 
    <div class="mb-3">
      <label for="exampleInputEmail1" class="form-label">Current Password</label>
      <input name="oldpassword" type="password" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp">
      <div id="emailHelp" class="form-text">Remember the password or you may get into trouble.</div>
    </div>
    <div class="mb-3">
      <label for="exampleInputPassword1" class="form-label">New Password</label>
      <input name="newpassword" type="password" class="form-control" id="exampleInputPassword1">
    </div>
    <div class="mb-3">
        <label for="exampleInputPassword2" class="form-label">Re-type New Password</label>
        <input name="renewpassword" type="password" class="form-control" id="exampleInputPassword2">
      </div>
    
    <button type="submit" onclick="changepassword('{{.ID}}')"  class="btn btn-primary">Submit</button>
  </form>
</div>



<script>
    function changepassword(ID){
const form = document.getElementById('form')
datas =  $('#form').serialize()

        form.addEventListener('submit', (e) => {
e.preventDefault()



swal({
  title: "Are you sure you want to change?",
  text: "Once changed, you will not be able to login with the old password!",
  icon: "warning",
  buttons: true,
  dangerMode: true,
})
.then((willDelete) => {
  if (willDelete) {

    
        $.ajax({
  type: "POST",
  url: "/user/settings/change_password/"+ID,
  data: datas,
  success: function(k){
    if(k=='wrongpassword'){
        swal("Wrong Password", "You enetered wrong password", "error");

    }else if(k == 'different'){
        swal("Passwords did not match!", "You enetered different passwords", "warning");
    }else if(k=='done'){
        swal("Successfully Updated!", "You changed your password successfully", "success");
        setTimeout(() => { location.href="/user/profile";  }, 1500);
    }else if(k=='same'){
        swal("Same Password", "You entered same password", "error");

    }
  }
  
});






  } 



});




  

 






        })//event listener
} //function close    
    
</script>
</body>
</html>